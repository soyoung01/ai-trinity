import pandas as pd

# 1. 50개 추가 운동 데이터 (ID 31 ~ 80)
raw_data_new = [
    [31, "스모 스쿼트", "근력 운동", "중", "허벅지 안쪽과 엉덩이를 집중 공략하는 와이드 스쿼트", "맨몸", "하체", "내전근", 60, 15, 3, 60, "무릎, 고관절", 5.0],
    [32, "불가리안 스플릿 스쿼트", "근력 운동", "상", "한 다리로 수행하여 균형감과 힙업 효과 극대화", "맨몸", "하체", "대둔근", 60, 10, 3, 60, "무릎, 발목", 6.0],
    [33, "힙 쓰러스트", "근력 운동", "중", "엉덩이 근육만을 고립하여 폭발적인 힙업", "벤치", "하체", "대둔근", 60, 12, 3, 60, "허리", 4.5],
    [34, "고블렛 스쿼트", "근력 운동", "중", "덤벨을 가슴 앞에 들고 수행하여 코어와 하체 동시 자극", "덤벨", "하체", "대퇴사두근", 60, 12, 3, 60, "허리, 무릎", 5.5],
    [35, "스티프 레그 데드리프트", "근력 운동", "중", "햄스트링과 엉덩이 라인을 예쁘게 다듬는 운동", "바벨", "하체", "햄스트링", 60, 12, 3, 60, "허리", 5.0],
    [36, "라잉 레그 컬", "근력 운동", "하", "엎드려서 수행하는 햄스트링 고립 운동", "머신", "하체", "햄스트링", 40, 15, 3, 45, "허리, 무릎", 3.5],
    [37, "이너 타이 머신", "근력 운동", "하", "허벅지 안쪽 살을 탄력있게 만드는 머신 운동", "머신", "하체", "내전근", 40, 15, 3, 45, "고관절", 3.0],
    [38, "핵 스쿼트", "근력 운동", "상", "머신을 이용해 하체 전면부를 강력하게 타격", "머신", "하체", "대퇴사두근", 60, 10, 3, 90, "무릎, 허리", 6.0],
    [39, "시티드 카프 레이즈", "근력 운동", "하", "앉아서 수행하여 종아리 근육(가자미근) 집중", "머신", "하체", "비복근", 30, 20, 3, 30, "발목", 2.5],
    [40, "인클라인 벤치 프레스", "근력 운동", "상", "윗가슴을 채워 볼륨감 있는 상체 완성", "바벨", "가슴", "대흉근", 60, 10, 3, 90, "어깨", 4.5],
    [41, "체스트 프레스 머신", "근력 운동", "하", "초보자도 안전하게 가슴 근육을 자극하는 머신", "머신", "가슴", "대흉근", 50, 12, 3, 60, "어깨", 3.5],
    [42, "딥스", "근력 운동", "상", "아랫가슴과 삼두근을 동시에 발달시키는 맨몸 운동", "맨몸", "가슴", "대흉근", 40, 8, 3, 90, "어깨, 팔꿈치", 5.0],
    [43, "케이블 크로스 오버", "근력 운동", "중", "가슴 안쪽 라인을 선명하게 모아주는 운동", "머신", "가슴", "대흉근", 50, 15, 3, 45, "어깨", 3.5],
    [44, "무릎을 댄 푸시업", "근력 운동", "하", "근력이 부족한 초보자를 위한 쉬운 푸시업", "맨몸", "가슴", "대흉근", 40, 10, 3, 45, "손목", 3.0],
    [45, "인클라인 덤벨 프레스", "근력 운동", "중", "덤벨을 이용해 윗가슴 가동범위를 극대화", "덤벨", "가슴", "대흉근", 60, 12, 3, 60, "어깨", 4.0],
    [46, "티바 로우", "근력 운동", "상", "등의 두께감과 중앙부를 강력하게 타격", "바벨", "등", "광배근", 60, 10, 3, 90, "허리", 5.0],
    [47, "원 암 덤벨 로우", "근력 운동", "중", "한 팔씩 집중하여 광배근 하부를 자극", "덤벨", "등", "광배근", 50, 12, 3, 60, "허리", 4.0],
    [48, "케이블 시티드 로우", "근력 운동", "중", "케이블의 지속적인 저항으로 등 근육 자극", "머신", "등", "광배근", 50, 12, 3, 60, "허리", 4.0],
    [49, "어시스트 풀업", "근력 운동", "하", "머신의 도움을 받아 풀업 자세 익히기", "머신", "등", "광배근", 60, 10, 3, 60, "어깨", 4.0],
    [50, "스트레이트 암 풀다운", "근력 운동", "중", "팔을 편 채로 광배근만을 고립하여 자극", "머신", "등", "광배근", 40, 15, 3, 45, "어깨, 팔꿈치", 3.5],
    [51, "아놀드 프레스", "근력 운동", "상", "전면, 측면 어깨를 동시에 회전하며 자극", "덤벨", "어깨", "삼각근", 50, 12, 3, 60, "어깨", 4.0],
    [52, "페이스 풀", "근력 운동", "중", "후면 어깨와 회전근개를 강화하여 라운드 숄더 교정", "머신", "어깨", "삼각근", 40, 15, 3, 45, "어깨", 3.5],
    [53, "비하인드 넥 프레스", "근력 운동", "상", "목 뒤로 바벨을 내려 측면 어깨 고립 (숙련자용)", "바벨", "어깨", "삼각근", 60, 10, 3, 90, "어깨, 목", 4.5],
    [54, "벤트 오버 레터럴 레이즈", "근력 운동", "중", "상체를 숙여 후면 어깨 근육을 집중 공략", "덤벨", "어깨", "삼각근", 40, 15, 3, 45, "허리", 3.5],
    [55, "업라이트 로우", "근력 운동", "중", "바벨을 턱 밑까지 들어올려 승모근과 어깨 자극", "바벨", "어깨", "승모근", 50, 12, 3, 60, "어깨, 손목", 4.0],
    [56, "해머 컬", "근력 운동", "하", "전완근과 이두 바깥쪽을 발달시켜 팔의 입체감 완성", "덤벨", "팔", "상완이두근", 40, 12, 3, 45, "팔꿈치", 3.5],
    [57, "케이블 푸시 다운", "근력 운동", "하", "삼두근 외측두를 선명하게 만드는 대표 운동", "머신", "팔", "상완삼두근", 40, 15, 3, 45, "팔꿈치", 3.5],
    [58, "바벨 컬", "근력 운동", "중", "고중량으로 이두근 사이즈를 키우는 운동", "바벨", "팔", "상완이두근", 50, 10, 3, 60, "손목, 허리", 4.0],
    [59, "라잉 트라이셉스 익스텐션", "근력 운동", "중", "누워서 이마 쪽으로 바벨을 내려 삼두 자극", "바벨", "팔", "상완삼두근", 50, 12, 3, 60, "팔꿈치", 4.0],
    [60, "리버스 컬", "근력 운동", "하", "손등이 위로 가게 잡아 전완근 강화", "바벨", "팔", "상완이두근", 40, 12, 3, 45, "손목", 3.0],
    [61, "행잉 레그 레이즈", "코어", "상", "철봉에 매달려 하복부를 들어올리는 고강도 복근 운동", "철봉", "복부", "복직근", 30, 10, 3, 60, "허리, 어깨", 5.0],
    [62, "AB 슬라이드", "코어", "상", "롤러를 밀고 당기며 복부 전체에 강력한 자극", "맨몸", "복부", "복직근", 40, 10, 3, 60, "허리", 5.0],
    [63, "브이업", "코어", "상", "상체와 하체를 동시에 들어올려 복부 전체 수축", "맨몸", "복부", "복직근", 40, 12, 3, 45, "허리", 4.5],
    [64, "시티드 니업", "코어", "하", "의자에 앉아 무릎을 가슴으로 당기는 쉬운 복근 운동", "벤치", "복부", "복직근", 30, 20, 3, 30, "허리", 3.0],
    [65, "힐 터치", "코어", "하", "누워서 발뒤꿈치를 터치하며 옆구리 자극", "매트", "복부", "외복사근", 30, 20, 3, 30, "목", 2.5],
    [66, "점프 로프 (줄넘기)", "유산소", "중", "전신 체지방 연소와 심폐지구력 향상에 탁월", "맨몸", "전신", "전신 근육", 60, 100, 3, 30, "무릎, 발목", 10.0],
    [67, "배틀 로프", "유산소", "상", "밧줄을 힘차게 흔들며 상체 근력과 유산소 동시 해결", "맨몸", "전신", "전신 근육", 30, 1, 5, 30, "어깨, 허리", 9.0],
    [68, "케틀벨 스윙", "유산소", "중", "힙 드라이브를 이용해 전신 파워와 코어 강화", "케틀벨", "전신", "대둔근", 40, 20, 3, 45, "허리", 7.0],
    [69, "박스 점프", "플라이오메트릭", "상", "박스 위로 점프하여 폭발적인 하체 파워 향상", "맨몸", "하체", "대퇴사두근", 30, 10, 3, 60, "무릎, 발목", 8.0],
    [70, "제자리 달리기", "유산소", "하", "집에서도 층간소음 없이 할 수 있는 유산소", "맨몸", "전신", "전신 근육", 60, 1, 3, 30, "무릎", 6.0],
    [71, "스텝밀 (천국의 계단)", "유산소", "상", "계단을 오르며 칼로리 소모와 힙업 효과", "머신", "하체", "대둔근", 300, 1, 1, 0, "무릎", 9.0],
    [72, "로잉 머신", "유산소", "상", "노를 젓는 동작으로 전신 근육 사용 및 유산소 효과", "머신", "전신", "광배근", 300, 1, 1, 0, "허리", 8.5],
    [73, "폼롤러 쿼드 스트레칭", "스트레칭", "하", "폼롤러로 앞허벅지 근막을 이완하여 피로 회복", "폼롤러", "하체", "대퇴사두근", 60, 1, 2, 10, "무릎", 2.0],
    [74, "폼롤러 종아리 마사지", "스트레칭", "하", "뭉친 종아리를 풀어주어 부종 완화", "폼롤러", "하체", "비복근", 60, 1, 2, 10, "없음", 2.0],
    [75, "어깨 회전근개 스트레칭", "스트레칭", "하", "어깨 관절의 가동성을 높여 부상 예방", "밴드", "어깨", "삼각근", 40, 15, 2, 10, "어깨", 1.5],
    [76, "이상근 스트레칭", "스트레칭", "하", "엉덩이 깊은 곳을 늘려 허리 통증 완화", "매트", "하체", "대둔근", 60, 1, 2, 10, "고관절", 2.0],
    [77, "광배근 스트레칭", "스트레칭", "하", "팔을 위로 뻗어 옆구리와 등을 시원하게 이완", "맨몸", "등", "광배근", 30, 1, 2, 10, "어깨", 1.5],
    [78, "손목 스트레칭", "스트레칭", "하", "손목 관절을 풀어주어 손목 터널 증후군 예방", "맨몸", "팔", "전신 근육", 30, 1, 2, 10, "손목", 1.0],
    [79, "목 스트레칭", "스트레칭", "하", "목 주변 근육을 이완하여 거북목 교정 도움", "맨몸", "상체", "승모근", 30, 1, 2, 10, "목", 1.0],
    [80, "전신 털기", "스트레칭", "하", "가볍게 몸을 흔들어 긴장된 근육 이완 (모관운동)", "맨몸", "전신", "전신 근육", 60, 1, 1, 0, "없음", 1.5]
]

# 2. Detail Data (Descriptions & Cautions)
details_content_new = {
    "스모 스쿼트": (["다리를 어깨너비 1.5배로 벌리고 발끝을 45도 바깥으로 둡니다.", "허리를 펴고 엉덩이를 수직으로 내립니다.", "허벅지 안쪽 힘으로 일어납니다."], ["무릎이 안쪽으로 쏠리지 않게 주의하세요."]),
    "불가리안 스플릿 스쿼트": (["벤치에 한쪽 발등을 올리고 섭니다.", "앞쪽 다리 무릎을 굽혀 앉습니다.", "앞발 뒤꿈치로 밀어 일어납니다."], ["무릎이 발끝을 과도하게 넘지 않도록 합니다."]),
    "힙 쓰러스트": (["벤치에 날개뼈를 대고 앉아 골반 위에 바벨을 올립니다.", "발바닥으로 밀어 엉덩이를 들어올립니다.", "최고점에서 엉덩이를 강하게 수축합니다."], ["허리가 과하게 꺾이지 않도록 복압을 유지하세요."]),
    "고블렛 스쿼트": (["덤벨을 가슴 앞에 세로로 잡고 섭니다.", "그대로 앉았다 일어납니다.", "상체가 앞으로 쏠리지 않게 주의합니다."], ["팔 힘이 아닌 하체 힘으로 움직이세요."]),
    "스티프 레그 데드리프트": (["무릎을 살짝만 굽힌 채 상체를 숙입니다.", "햄스트링이 늘어나는 것을 느끼며 바벨을 내립니다.", "엉덩이를 앞으로 밀어넣으며 일어납니다."], ["허리가 굽지 않도록 척추 중립을 유지하세요."]),
    "라잉 레그 컬": (["머신에 엎드려 발목 패드를 겁니다.", "뒷허벅지 힘으로 패드를 엉덩이 쪽으로 당깁니다.", "천천히 저항을 느끼며 내립니다."], ["엉덩이가 들썩거리지 않도록 고정하세요."]),
    "이너 타이 머신": (["머신에 앉아 다리 안쪽에 패드를 댑니다.", "다리를 안으로 모아줍니다.", "천천히 벌려줍니다."], ["반동을 쓰지 말고 지그시 모으세요."]),
    "핵 스쿼트": (["머신 등받이에 등을 대고 섭니다.", "안전바를 풀고 앉았다 일어납니다."], ["무릎 관절을 다 펴서 잠그지(Locking) 마세요."]),
    "시티드 카프 레이즈": (["머신에 앉아 무릎 위에 패드를 고정합니다.", "발뒤꿈치를 들어올려 종아리를 수축합니다.", "최대한 내렸다가 다시 올립니다."], ["발목 가동범위를 전체적으로 사용하세요."]),
    "인클라인 벤치 프레스": (["벤치 각도를 30~45도로 세팅하고 눕습니다.", "바벨을 쇄골 쪽으로 내립니다.", "겨드랑이 쪽으로 밀어올립니다."], ["손목이 꺾이지 않게 주의하세요."]),
    "체스트 프레스 머신": (["머신에 앉아 손잡이가 가슴 중앙에 오게 맞춥니다.", "앞으로 밀어냅니다.", "천천히 돌아옵니다."], ["어깨가 으쓱하지 않게 주의하세요."]),
    "딥스": (["평행봉을 잡고 팔을 펴서 매달립니다.", "상체를 앞으로 숙이며 내려갑니다.", "가슴 힘으로 밀어올립니다."], ["어깨 통증이 심하면 가동범위를 줄이세요."]),
    "케이블 크로스 오버": (["케이블 머신 중앙에 서서 손잡이를 잡습니다.", "가슴 안쪽으로 팔을 모아줍니다.", "천천히 벌려줍니다."], ["팔꿈치 각도를 일정하게 유지하세요."]),
    "푸시업 (무릎 대고)": (["무릎을 바닥에 대고 푸시업 자세를 잡습니다.", "가슴이 바닥에 닿을 듯 내려갑니다.", "밀어올립니다."], ["엉덩이가 뒤로 빠지지 않게 주의하세요."]),
    "인클라인 덤벨 프레스": (["각도 조절 벤치에 누워 덤벨을 듭니다.", "쇄골 쪽 라인으로 내렸다가 밀어올립니다."], ["덤벨이 흔들리지 않게 균형을 잡으세요."]),
    "티바 로우": (["바를 잡고 상체를 숙입니다.", "등 중앙으로 바를 당깁니다.", "천천히 내립니다."], ["허리 반동을 쓰지 마세요."]),
    "원 암 덤벨 로우": (["벤치에 한 손과 무릎을 대고 엎드립니다.", "덤벨을 든 팔을 골반 쪽으로 당깁니다.", "광배근을 늘려주며 내립니다."], ["몸통이 회전하지 않도록 고정하세요."]),
    "케이블 시티드 로우": (["발판을 딛고 앉아 핸들을 잡습니다.", "배꼽 쪽으로 당기며 날개뼈를 모읍니다.", "등을 늘려주며 돌아갑니다."], ["상체가 과하게 뒤로 눕지 않게 하세요."]),
    "어시스트 풀업": (["머신 발판에 무릎을 대고 매달립니다.", "가슴을 펴고 올라갑니다.", "천천히 내려옵니다."], ["어깨가 올라가지 않게 눌러주세요."]),
    "스트레이트 암 풀다운": (["케이블 바를 잡고 팔을 편 채로 섭니다.", "허벅지 쪽으로 바를 누르듯 내립니다.", "광배근 저항을 느끼며 올립니다."], ["팔꿈치를 굽히지 마세요."]),
    "아놀드 프레스": (["덤벨을 손등이 앞을 보게 잡습니다.", "손목을 회전시키며 머리 위로 듭니다.", "역순으로 돌아옵니다."], ["어깨 충돌이 느껴지면 중단하세요."]),
    "페이스 풀": (["로프를 잡고 눈 높이로 당깁니다.", "팔꿈치를 뒤로 보내며 등을 수축합니다.", "천천히 돌아갑니다."], ["승모근이 개입되지 않게 주의하세요."]),
    "비하인드 넥 프레스": (["바벨을 목 뒤로 내립니다.", "귀 높이까지만 내렸다가 올립니다."], ["목을 다치지 않게 주의하세요."]),
    "벤트 오버 레터럴 레이즈": (["상체를 숙이고 덤벨을 듭니다.", "양옆으로 팔을 벌려 들어올립니다.", "천천히 내립니다."], ["반동을 최소화하세요."]),
    "업라이트 로우": (["바벨을 좁게 잡고 섭니다.", "팔꿈치를 높게 들어 바를 턱 밑까지 올립니다.", "천천히 내립니다."], ["손목이 꺾이지 않게 주의하세요."]),
    "해머 컬": (["덤벨을 세로로 잡고 섭니다.", "그대로 들어올립니다.", "천천히 내립니다."], ["팔꿈치를 고정하세요."]),
    "케이블 푸시 다운": (["로프나 바를 잡고 팔꿈치를 옆구리에 붙입니다.", "아래로 힘껏 누릅니다.", "팔꿈치를 고정한 채 올립니다."], ["상체 반동을 쓰지 마세요."]),
    "바벨 컬": (["바벨을 어깨너비로 잡습니다.", "이두근 힘으로 들어올립니다.", "저항을 느끼며 내립니다."], ["허리가 뒤로 젖혀지지 않게 하세요."]),
    "라잉 트라이셉스 익스텐션": (["벤치에 누워 바벨을 듭니다.", "이마 쪽으로 팔꿈치를 접어 내립니다.", "삼두 힘으로 폅니다."], ["팔꿈치가 벌어지지 않게 모으세요."]),
    "리버스 컬": (["손등이 보이게 바벨을 잡습니다.", "그대로 들어올립니다.", "천천히 내립니다."], ["손목 부상에 주의하세요."]),
    "행잉 레그 레이즈": (["철봉에 매달립니다.", "다리를 들어올려 복부를 수축합니다.", "천천히 내립니다."], ["몸이 흔들리지 않게 제어하세요."]),
    "AB 슬라이드": (["무릎을 대고 롤러를 잡습니다.", "앞으로 밀고 나갑니다.", "복부 힘으로 당겨옵니다."], ["허리가 꺾이면 부상 위험이 큽니다."]),
    "브이업": (["누워서 팔다리를 뻗습니다.", "동시에 들어올려 몸을 V자로 만듭니다.", "천천히 펴줍니다."], ["반동을 쓰지 마세요."]),
    "시티드 니업": (["의자에 걸터앉아 손으로 뒤를 잡습니다.", "무릎을 가슴 쪽으로 당깁니다.", "다리를 뻗어줍니다."], ["상체를 살짝 뒤로 기울이세요."]),
    "힐 터치": (["무릎을 세우고 눕습니다.", "상체를 살짝 들어 좌우 발뒤꿈치를 터치합니다."], ["목에 힘을 빼세요."]),
    "점프 로프 (줄넘기)": (["줄을 잡고 제자리에서 뜁니다.", "리듬감 있게 줄을 넘습니다."], ["무릎 충격을 줄이려면 푹신한 곳에서 하세요."]),
    "배틀 로프": (["밧줄 끝을 잡고 기마자세를 취합니다.", "양손으로 번갈아 줄을 흔듭니다."], ["코어 힘을 유지하세요."]),
    "케틀벨 스윙": (["다리 사이로 케틀벨을 보냅니다.", "엉덩이를 튕기며 앞으로 던지듯 올립니다."], ["팔 힘이 아닌 엉덩이 힘으로 하세요."]),
    "박스 점프": (["박스 앞에 섭니다.", "힘껏 점프하여 박스 위에 착지합니다.", "일어섰다가 내려옵니다."], ["착지 시 무릎을 굽혀 충격을 흡수하세요."]),
    "제자리 달리기": (["제자리에서 가볍게 뜁니다.", "팔을 앞뒤로 흔듭니다."], ["발소리가 나지 않게 가볍게 뛰세요."]),
    "스텝밀 (천국의 계단)": (["계단을 오릅니다.", "발바닥 전체로 딛습니다."], ["손잡이에 너무 기대지 마세요."]),
    "로잉 머신": (["발을 고정하고 핸들을 잡습니다.", "다리로 밀며 핸들을 당깁니다.", "역순으로 돌아갑니다."], ["허리를 곧게 펴세요."]),
    "폼롤러 쿼드 스트레칭": (["엎드려 허벅지 아래 폼롤러를 둡니다.", "위아래로 롤링합니다."], ["통증이 심한 곳은 지그시 누르세요."]),
    "폼롤러 종아리 마사지": (["앉아서 종아리 아래 폼롤러를 둡니다.", "앞뒤로 문지릅니다."], ["엉덩이를 들면 자극이 강해집니다."]),
    "어깨 회전근개 스트레칭": (["밴드를 잡고 팔꿈치를 붙입니다.", "바깥쪽으로 돌립니다."], ["어깨가 뜨지 않게 하세요."]),
    "이상근 스트레칭": (["누워서 다리를 4자로 꼬아 당깁니다.", "엉덩이 쪽 자극을 느낍니다."], ["허리가 바닥에서 뜨지 않게 하세요."]),
    "광배근 스트레칭": (["기둥을 잡고 엉덩이를 뒤로 뺍니다.", "옆구리를 늘려줍니다."], ["시선은 바닥을 봅니다."]),
    "손목 스트레칭": (["팔을 뻗고 손등을 당깁니다.", "반대로 손바닥을 당깁니다."], ["너무 세게 당기지 마세요."]),
    "목 스트레칭": (["한 손으로 머리를 잡고 당깁니다.", "반대쪽 어깨를 내립니다."], ["천천히 늘려주세요."]),
    "전신 털기": (["편하게 서서 팔다리를 텁니다.", "몸 전체 긴장을 풉니다."], ["호흡을 자연스럽게 하세요."])
}

# 3. Mappings (DDL based)
map_difficulty = {"하": "EASY", "중": "MEDIUM", "상": "HARD"}
map_equipment = {
    "맨몸": "BODY_WEIGHT", "덤벨": "DUMBBELL", "매트": "MAT", "머신": "MACHINE", "바벨": "BARBELL", 
    "철봉": "PULL_UP_BAR", "밴드": "BAND", "폼롤러": "FOAM_ROLLER", "짐볼": "GYM_BALL", 
    "케틀벨": "KETTLE_BELL", "벤치": "BENCH"
}
map_target_area = {
    "하체": "LOWER_BODY", "상체": "UPPER_BODY", "전신": "FULL_BODY", "팔": "ARMS", 
    "복부": "ABDOMEN", "어깨": "SHOULDERS", "등": "BACK", "가슴": "CHEST", "유산소": "CARDIO"
}
map_type = {
    "근력 운동": "STRENGTH_TRAINING", "유산소": "CARDIO", "스트레칭": "STRETCHING", 
    "코어": "CORE", "밸런스": "BALANCE", "플라이오메트릭": "PLYOMETRICS"
}
map_primary_muscle = {
    "대퇴사두근": "QUADRICEPS_FEMORIS", "대둔근": "GLUTEUS_MAXIMUS", "햄스트링": "HAMSTRINGS", 
    "비복근": "GASTROCNEMIUS", "대흉근": "PECTORALIS_MAJOR", "광배근": "LATISSIMUS_DORSI", 
    "척추기립근": "ERECTOR_SPINAE", "삼각근": "DELTOID", "상완이두근": "BICEPS_BRACHII", 
    "상완삼두근": "TRICEPS_BRACHII", "복직근": "RECTUS_ABDOMINIS", "외복사근": "EXTERNAL_OBLIQUE", 
    "전신 근육": "GENERAL_MUSCLES", "내전근": "ADDUCTORS", "승모근": "TRAPEZIUS"
}
map_restricts = {
    "무릎": "KNEES", "허리": "WAIST", "발목": "ANKLES", "손목": "WRISTS", 
    "어깨": "SHOULDERS", "목": "NECK", "팔꿈치": "ELBOWS", "햄스트링": "HAMSTRINGS", 
    "고관절": "WAIST", "없음": None
}

# 4. SQL Statement Generation
sql_statements = []
base_img_url = "https://mofit-image.s3.ap-northeast-2.amazonaws.com/exercises/"

def get_sql_val(v):
    if v is None: return "NULL"
    if isinstance(v, str): return f"'{v}'"
    return str(v)

# Transaction Start
sql_statements.append("START TRANSACTION;")
sql_statements.append("-- 50 Additional Exercises (IDs 31-80)")

for row in raw_data_new:
    eid, name, etype, diff, intro, equip, target, muscle, dur, reps, sets, rest, contra_str, mets = row
    
    # 1. Exercise Insert
    img_url = f"{base_img_url}{eid}.png"
    vals = [
        eid, "NOW()", "NOW()", map_difficulty.get(diff), dur, map_equipment.get(equip),
        name, img_url, intro, mets, map_primary_muscle.get(muscle), reps, rest, sets,
        map_target_area.get(target), map_type.get(etype)
    ]
    vals_str = ", ".join([get_sql_val(v) if v != "NOW()" else "NOW()" for v in vals])
    
    sql_statements.append(f"INSERT INTO exercise (id, created_at, updated_at, difficulty, duration_sec, equipment, exercise_name, image, intro, mets, primary_muscle, reps, rest_sec, sets, target_area, type) VALUES ({vals_str});")

    # 2. Restricts Insert
    if contra_str and contra_str != "없음":
        items = [x.strip() for x in str(contra_str).split(",")]
        for item in items:
            restrict_enum = map_restricts.get(item)
            if restrict_enum:
                sql_statements.append(f"INSERT INTO exercise_restricts (exercise_id, exercise_restrict) VALUES ({eid}, '{restrict_enum}');")

    # 3. Detail Insert (Assuming auto-increment ID for detail table, so we omit 'id' column)
    if name in details_content_new:
        descs, cauts = details_content_new[name]
        for seq, txt in enumerate(descs, 1):
            sql_statements.append(f"INSERT INTO detail (created_at, updated_at, category, content, sequence, exercise_id) VALUES (NOW(), NOW(), 'DESCRIPTION', '{txt}', {seq}, {eid});")
        for seq, txt in enumerate(cauts, 1):
            sql_statements.append(f"INSERT INTO detail (created_at, updated_at, category, content, sequence, exercise_id) VALUES (NOW(), NOW(), 'CAUTION', '{txt}', {seq}, {eid});")

sql_statements.append("COMMIT;")

# Save to SQL file
with open("insert_additional_50.sql", "w", encoding="utf-8") as f:
    f.write("\n".join(sql_statements))

print("SQL file created.")